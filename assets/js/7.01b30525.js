(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{437:function(a,t,s){"use strict";s.r(t);var e=s(57),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"aula-teorica-comunicacao-com-api-telegram-bot"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#aula-teorica-comunicacao-com-api-telegram-bot"}},[a._v("#")]),a._v(" Aula teórica - Comunicação com API-TELEGRAM-BOT")]),a._v(" "),s("p",[a._v("Comunicação com API-TELEGRAM-BOT, como receber e responder uma solicitação.")]),a._v(" "),s("p",[a._v("A comunicação entre seu projeto com a "),s("a",{attrs:{href:"https://core.telegram.org/bots/api",target:"_blank",rel:"noopener noreferrer"}},[a._v("API-TELEGRAM-BOT"),s("OutboundLink")],1),a._v(" é extremamente importante. Precisamos entender como esta comunicação funciona, para que possamos criar nossos projetos. Precisamos saber que ela é dividida em duas partes: A primeira enviando dados e a outra recebendo dados.")]),a._v(" "),s("p",[a._v("Na aula inicial, vimos como criar uma maneira de tratar a primeira parte dessa comunicação. Enviando mensagens, arquivos e manipulando todo e qualquer método da "),s("a",{attrs:{href:"https://core.telegram.org/bots/api",target:"_blank",rel:"noopener noreferrer"}},[a._v("API-TELEGRAM-BOT"),s("OutboundLink")],1),a._v("; Agora precisamos entender a segunda parte:")]),a._v(" "),s("p",[a._v("Recebimento de dados: Quando um usuário executa alguma ação no bot, ele espera por uma resposta. E para responder, precisamos saber o que é e quais são os dados dessa ação.")]),a._v(" "),s("h3",{attrs:{id:"como-recebemos-dados-da-api-telegram-bot"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#como-recebemos-dados-da-api-telegram-bot"}},[a._v("#")]),a._v(" Como recebemos dados da "),s("a",{attrs:{href:"https://core.telegram.org/bots/api",target:"_blank",rel:"noopener noreferrer"}},[a._v("API-TELEGRAM-BOT"),s("OutboundLink")],1),a._v("?")]),a._v(" "),s("p",[a._v("De acordo com o site oficial, "),s("a",{attrs:{href:"https://core.telegram.org/bots/api#getting-updates",target:"_blank",rel:"noopener noreferrer"}},[a._v("há duas maneiras de receber as informações"),s("OutboundLink")],1),a._v(": Por webhook e por long polling.")]),a._v(" "),s("p",[a._v("Fique tranquilo, pois iremos abordar essas duas maneiras de forma separada.")]),a._v(" "),s("hr"),a._v(" "),s("h3",{attrs:{id:"long-polling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#long-polling"}},[a._v("#")]),a._v(" Long Polling")]),a._v(" "),s("h4",{attrs:{id:"o-que-e-long-polling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#o-que-e-long-polling"}},[a._v("#")]),a._v(" O que é Long Polling?")]),a._v(" "),s("p",[a._v("É uma técnica "),s("a",{attrs:{href:"https://pt.wikipedia.org/wiki/Comet_(programa%C3%A7%C3%A3o)",target:"_blank",rel:"noopener noreferrer"}},[a._v("comet"),s("OutboundLink")],1),a._v(", que permite que a conexão fique aberta, aguardando uma resposta do servidor, quando a conexão recebe uma resposta, caso seja necessário tratamos ela, logo em seguida ela é fechada (independentemente se houver algo para ser tratado ou não). Depois, essa conexão é reaberta e inicia-se um novo "),s("a",{attrs:{href:"https://pt.wikipedia.org/wiki/Loop_(programa%C3%A7%C3%A3o)",target:"_blank",rel:"noopener noreferrer"}},[a._v("loop"),s("OutboundLink")],1),a._v(".")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://rodolfofadino.com.br/usando-long-polling-com-asynccontrollers-a72e15db2f9e",target:"_blank",rel:"noopener noreferrer"}},[a._v("Mais detalhes"),s("OutboundLink")],1),a._v(")")])]),a._v(" "),s("h3",{attrs:{id:"trabalhando-com-long-polling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#trabalhando-com-long-polling"}},[a._v("#")]),a._v(" Trabalhando com Long Polling")]),a._v(" "),s("p",[a._v("Para trabalharmos com Long Polling precisamos criar uma função que faça conexão com o método "),s("a",{attrs:{href:"https://core.telegram.org/bots/api#getupdates",target:"_blank",rel:"noopener noreferrer"}},[a._v("getUpdates"),s("OutboundLink")],1),a._v(" para isso usaremos o manipulador de métodos da API que abordamos na aula passada.")]),a._v(" "),s("p",[a._v("Nota: O objetivo das aulas não é ensinar programação. No entanto, deixarei um exemplo abaixo, de como devemos criar essa funcionalidade.")]),a._v(" "),s("ul",[s("li",[a._v("Lembre-se de adicionar sua token do bot ao manipulador de métodos.")])]),a._v(" "),s("p",[a._v("Usarei essa funcionalidade para o Long Polling:")]),a._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" json\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("longpolling")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[a._v('"""\n    Essa funcionalidade permitirá que você faça checagem de novas ações e colete os dados,\n    caso houver, ela retornará o que encontrar, caso não tenha nada, ela retornará algo pré-definido\n    isso fará com que o loop não seja interrompido.\n    """')]),a._v("\n    temp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        data "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sendTG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("method"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"getUpdates"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" offset"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("temp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" timeout"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("temp"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" allowed_updates"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        data "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"response"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"result"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            resp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" json"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("dumps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("dict")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ping"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'pong'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Estou definido algo para retorna, caso não encontre resultados")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("elif")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"result"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            temp  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'result'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'update_id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Aumentando o tempo")]),a._v("\n            resp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'result'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" resp\n")])])]),s("p",[a._v("Agora, precisamos tratar o que foi retornado. Então, criaremos algo para responder.")]),a._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("json\napi "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[a._v('"""\n    Essa função receberá eventos, porém só irá fazer o tratamento dos evento que possuam a chave: "message"; no vetor;  \n    caso seja encontrado essa chave, responderá com a palavra: PONG\n    Nota: os retornos de resposta são apenas exemplos, você pode alterar ou adicionar da maneira que preferir.\n    """')]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        msg "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'text'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sendTG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("chat_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("msg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'chat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" text"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'PONG'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v("Ok, vamos unificar as duas funções para trabalharem no mesmo script.")]),a._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("json\napi "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("longpolling")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[a._v('"""\n    Essa funcionalidade permitirá que você faça checagem de novas ações e colete os dados,\n    caso houver, ela retornará o que encontrar, caso não tenha nada, ela retornará algo pré-definido\n    isso fará com que o loop não seja interrompido.\n    """')]),a._v("\n    temp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        data "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sendTG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("method"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"getUpdates"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" offset"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("temp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" timeout"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("temp"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" allowed_updates"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        data "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"response"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" \n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("len")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"result"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            resp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" json"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("dumps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("dict")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("ping"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'pong'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Estou definido algo para retorna, caso não encontre resultados")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("elif")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"result"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            temp  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'result'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'update_id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Aumentando o tempo")]),a._v("\n            resp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'result'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        handler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("resp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[a._v('"""\n    Essa função receberá eventos, porém só irá fazer o tratamento dos evento que possuam a chave: "message"; no vetor;  \n    caso seja encontrado essa chave, responderá com a palavra: PONG\n    Nota: os retornos de resposta são apenas exemplos, você pode alterar ou adicionar da maneira que preferir.\n    """')]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'text'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sendTG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("chat_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'chat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" text"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'PONG'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" __name__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'__main__'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("try")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Iniciando o bot"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        longpolling"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Chamando a função para iniciar o long polling")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("except")]),a._v(" KeyboardInterrupt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Caso vocÊ execute: CTRL C")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\\nEncerrando o bot"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),s("p",[a._v('Pronto, já temos o nosso bot rodando via polling e respondendo todos os evento com a chave "message", em outras aulas criaremos novos recursos.')]),a._v(" "),s("hr"),a._v(" "),s("h3",{attrs:{id:"webhook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webhook"}},[a._v("#")]),a._v(" Webhook")]),a._v(" "),s("h4",{attrs:{id:"o-que-e-webhook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#o-que-e-webhook"}},[a._v("#")]),a._v(" O que é Webhook?")]),a._v(" "),s("p",[a._v("Webhooks são retornos de chamada HTTP e/ou HTTPS em seu servidor web, esse sistema possui uma flexibilidade para integrar fluxo para essas chamadas de maneira que conseguimos tratar cada chamada que recebemos, sendo ele um sistema impressionantemente simples de implementar em qualquer linguagem de programação.")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://pt.wikipedia.org/wiki/Webhook",target:"_blank",rel:"noopener noreferrer"}},[a._v("Mais detalhes"),s("OutboundLink")],1)])]),a._v(" "),s("h3",{attrs:{id:"trabalhando-com-webhook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#trabalhando-com-webhook"}},[a._v("#")]),a._v(" Trabalhando com Webhook")]),a._v(" "),s("p",[a._v("Basicamente, quando definimos para a "),s("a",{attrs:{href:"https://core.telegram.org/bots/api",target:"_blank",rel:"noopener noreferrer"}},[a._v("API-TELEGRAM-BOT"),s("OutboundLink")],1),a._v(" que iremos receber todas as novas requisições por webhook, o próprio Telegram encarrega-se de fazer chamadas carregando informações das ações executadas pelo usuários em nosso servidor web, restando apenas tratar essas informações e, para isso devemos subir um servidor web em nossa máquina e montar uma função para manipular as chamadas recebidas, mais uma vez usaremos o script que criamos na aula passada.")]),a._v(" "),s("p",[a._v("Nota: O objetivo das aulas não é ensinar programação. No entanto, deixarei um exemplo abaixo de como devemos criar essa funcionalidade. Lembre-se de adicionar sua token do bot ao manipulador de métodos. Falando sobre subir um servidor web, fique tranquilo, você pode usar o "),s("a",{attrs:{href:"https://ngrok.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("ngrok"),s("OutboundLink")],1),a._v(" (Inclusive, nessa aula\niremos usá-lo).")]),a._v(" "),s("p",[a._v("Primeiramente, precisamos deixar nosso servidor web online, "),s("a",{attrs:{href:"https://ngrok.com/download",target:"_blank",rel:"noopener noreferrer"}},[a._v("clique aqui"),s("OutboundLink")],1),a._v(" e, siga as instruções para fazer download do arquivo e descompactá-lo, agora com o arquivo descompactado, abra seu terminal na pasta onde ele está e execute: ngrok http 8443, ele vai gerar um link com HTTP e HTTPS, minimize o terminal e deixe rodando em segundo plano.")]),a._v(" "),s("p",[a._v("Agora vamos criar o nosso script para manipular as chamadas recebidas, usaremos a biblioteca "),s("a",{attrs:{href:"https://flask.palletsprojects.com/en/1.1.x/",target:"_blank",rel:"noopener noreferrer"}},[a._v("Flask"),s("OutboundLink")],1),a._v(" uma vez que na minha opinião é a melhor para\ntrabalharmos chamadas recebidas. Abaixo um exemplo de uso dessa\nbiblioteca.")]),a._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" json\napi "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\napp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[a._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("errorhandler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("404")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("server_error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("errorhandler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[a._v('"""\n    Se ocorrer algum erro com o código 404, a função abaixo será executada,\n    onde retornaremos o status 200 para eliminar toda e qualquer solicitação!\n\n    Porque? o webhook cria um tipo de loop, onde sempre repetirá a solicitação até seja tratada como status 200,\n    isto é, ele só encerra o loop quando recebe uma mensagem bem-sucedida de que, por padrão, possui o status 200,\n    Basicamente, isso resolverá o problema!\n    """')]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("status"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[a._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("before_request")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("handler")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("method "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'GET'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("and")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("path "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/webhookstart"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" \n        "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[a._v('"""\n        A partir daqui ele será lido apenas se o método de solicitação for "GET" e, \n        se o caminho for igual a "/webhookstart", se essas variáveis ​​forem verdadeiras, esse script \n        executará uma funcionalidade na API-TELEGRAM-BOT que fará com que a host seja reconhecida pelo flask\n        e, receba novos eventos do bot, ou seja, todas as novas solicitações serão enviadas apenas para o host detectável pelo "flask"\n        Nota: Caso esteja usando o ngrok não se preocupe em ter que alterar o HTTPS no código, \n        quando você executar o ngrok, ele gerará um link HTTPS, certo? acesse ele e adicione no final /webhookstart\n        exemplo: gerou o link: "https://232ih3h.ngrok.com", então você deverá acessar o link  https://232ih3h.ngrok.com/webhookstart\n        """')]),a._v("\n        r "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sendTG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("method"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"setWebhook"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" url"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[a._v('f"')]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("host"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('/webhook"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" max_connections"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" allowed_updates"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("response"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("r"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"response"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'description'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" status"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("method "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'POST'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("and")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("path "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/webhook"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[a._v('"""\n        A partir daqui será lido apenas se o método de solicitação for "POST" (padrão das chamadas do Telegram)\n        e, se o caminho for igual a "/webhook", se essas variáveis ​​forem verdadeiras, o script irár ler os eventos,\n        caso haja um evento com a chave: "messsage"; ele responderá com a palavra: PONG\n        Estou usando essa palavra apenas para saber que o script está funcionando, você poderá usar outra coisa\n        """')]),a._v("\n        vetor "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("get_json"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("silent"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" force"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# lendo os eventos recebido pela chamada")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'text'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n                api"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sendTG"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("chat_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("vetor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'chat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'id'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" text"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'PONG'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("status"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" __name__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'__main__'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("debug"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" port"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8443")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" host"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'127.0.0.1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Running app")]),a._v("\n")])])]),s("p",[a._v("Concluímos esta aula, aprendemos como funciona o recebimento de dados para novas ações por meio do long polling e webhook, criamos um script que faz o bot responder a essas novas ações e identifica as informações dela, em breve aprenderemos como usar todos os métodos "),s("a",{attrs:{href:"https://core.telegram.org/bots/api",target:"_blank",rel:"noopener noreferrer"}},[a._v("API-TELEGRAM-BOT"),s("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=n.exports}}]);